using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class PushOut : MonoBehaviour
{

    public float pushForce = 2f;  // ???? ?? ????
    public float controlDisableTime = 1f; // ??? ???? ??? ??? ?????
    private bool canControl = true;  // ??? ????? ?? ?????? ????? ????
    // Start is called before the first frame update
    void Start()
    {
        
    }

    // Update is called once per frame
    void Update()
    {
        
    }
    private void OnTriggerEnter(Collider other)
    {
        if (other.CompareTag("Obstacle")) // ??? ?? ????? ???? ?????? ???
        {
            Vector3 pushDirection = Vector3.zero;

            if (transform.position.x < other.transform.position.x)
            {
                // ??? ?? ?? ?????? ??? ? ?? ?? ?? ???
                pushDirection = Vector3.left;
            }
            else if (transform.position.x > other.transform.position.x)
            {
                // ??? ?? ???? ?????? ??? ? ?? ???? ?? ???
                pushDirection = Vector3.right;
            }

            // ????? ????? Push-Out
            StartCoroutine(Push_Out(pushDirection));
        }
    }

    private IEnumerator Push_Out(Vector3 direction)
    {
        canControl = false; // ??? ???? ???? ????? ??????

        float timer = 0f;
        while (timer < controlDisableTime)
        {
            transform.Translate(direction * pushForce * Time.deltaTime); // ????? ???? ?? ??? ?????
            timer += Time.deltaTime;
            yield return null;
        }

        canControl = true; // ??? ?? ???? ????? ????? ?? ???????
    }

    public bool CanControl()
    {
        return canControl;
    }
}
